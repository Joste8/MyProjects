<div class="card bg-dark text-white p-4">
    <h2>Product & Stock List</h2>
    <table class="table table-dark table-hover">
        <thead>
            <tr>
                <th>ID</th>
                <th>Name</th>
                <th>Attributes / Variants (Current Stock)</th>
            </tr>
        </thead>
        <tbody>
            {% for product in products %}
            <tr>
                <td>{{ product.id }}</td>
                <td>{{ product.name }}</td>
                <td>
                    {% for variant in product.variants %}
                        <span class="badge bg-primary">
                   
                            {{ variant.color }} | {{ variant.size }} (Qty: {{ variant.quantity }})
                        </span>
                    {% else %}
                        <span class="text-muted">No variants available</span>
                    {% endfor %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <hr>

    <h3>Add New Purchase</h3>
    <form action="{{ path('admin_purchase_add') }}" method="POST" class="row g-3">
        <div class="col-md-4">
            <input type="text" name="customer_name" class="form-control" placeholder="Customer Name" required>
        </div>
        <div class="col-md-4">
            <select name="variant_id" class="form-select" required>
                <option value="">Select Product & Variant</option>
                {% for product in products %}
                    {% for variant in product.variants %}
                     
                        <option value="{{ variant.id }}">
                            {{ product.name }} - {{ variant.color }} / {{ variant.size }} ({{ variant.quantity }} left)
                        </option>
                    {% endfor %}
                {% endfor %}
            </select>
        </div>
        <div class="col-md-2">
            <input type="number" name="quantity" class="form-control" placeholder="Qty" min="1" required>
        </div>
        <div class="col-md-2">
            <button type="submit" class="btn btn-info w-100">Complete Purchase</button>
        </div>
    </form>

    <hr>

    <h3>Purchase History Log</h3>
    <table class="table table-dark table-striped">
        <thead>
            <tr>
                <th style="padding: 18px;">Customer Name</th>
                <th style="padding: 18px;">Item Details</th>
                <th style="padding: 18px; text-align: center;">Quantity</th>
                <th style="padding: 18px;">Date</th>
            </tr>
        </thead>
        <tbody>
            {% for log in purchases %}
            <tr>
                <td style="padding: 18px; color: #ffffff; font-weight: bold;">
                    {{ log.customer.name|default('Walking Customer') }}
                </td>
                <td style="padding: 18px;">
                    <div style="color: #ffffff; font-size: 0.95rem;">{{ log.itemName }}</div>
                   
                    {% if log.productVariant %}
                        <div style="color: #5ba6ff; font-size: 0.75rem; font-weight: bold; margin-top: 4px;">
                            VARIANT: {{ log.productVariant }} 
                        </div>
                    {% endif %}
                </td>
                <td style="padding: 18px; text-align: center;">
                    <span style="background: rgba(248, 81, 73, 0.1); color: #ff7b72; padding: 4px 10px; border-radius: 20px; font-weight: bold;">
                        {{ log.quantity }}
                    </span>
                </td>
                <td style="padding: 18px; font-size: 0.85rem; color: #8b949e;">
                    {{ log.purchasedAt|date('d-M-Y H:i') }}
                </td>
            </tr>
            {% else %}
            <tr>
                <td colspan="4" class="text-center p-4 text-muted">No purchase history found.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>